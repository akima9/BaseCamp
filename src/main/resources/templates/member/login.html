<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}">
<div layout:fragment="content" class="container">
    <input type="hidden" id="resCode" th:value="${resCode}">
    <h1>Login.</h1>
    <form method="post" th:action="@{/login}" onsubmit="return login.validateForm()">
        <div class="mb-3">
            <label for="inputMemberId" class="form-label">ID</label>
            <input type="text" class="form-control" id="inputMemberId" name="memberId">
        </div>
        <div class="mb-3">
            <label for="inputMemberPw" class="form-label">Password</label>
            <input type="password" class="form-control" id="inputMemberPw" name="memberPw">
        </div>
        <button type="submit" class="btn btn-primary w-100">로그인</button>
        <button type="button" class="btn btn-primary w-100 mt-1 btn-light sign-up-btn">회원가입</button>
    </form>

    <script>
        let login = {
            init : function () {
                let signUpBtn = document.querySelector(".sign-up-btn");
                let resCode = document.querySelector("#resCode");

                function goToSignUpPage() {
                    self.location = "/signUp";
                }

                signUpBtn.addEventListener('click', goToSignUpPage);

                if (resCode.value.length > 0) {
                    if (resCode.value == 404) {
                        alert("회원가입 하지 않은 아이디 입니다.");
                    } else if (resCode.value == 200) {
                        alert("회원가입 되었습니다.");
                    } else if (resCode.value == 405) {
                        alert("비밀번호가 일치하지 않습니다.");
                    } else if (resCode.value == 600) {
                        alert("로그인 후 이용 가능 합니다.");
                    }
                }
            },
            validateForm : function () {
                let memberId = document.querySelector('input[name=memberId]');
                let memberPw = document.querySelector('input[name=memberPw]');

                if (memberId.value.length < 2) {
                    alert("2글자 이상의 ID를 입력해주세요.");
                    memberId.focus();
                    return false;
                }

                if (memberPw.value.length < 6) {
                    alert("6글자 이상의 비밀번호를 입력해주세요.");
                    memberPw.focus();
                    return false;
                }

                return true;
            }
        }

        login.init();
    </script>
</div>
</html>